:root{--ninja-kai: #C41E3A;--ninja-jay: #0047AB;--ninja-cole: #2F2F2F;--ninja-zane: #87CEEB;--ninja-lloyd: #228B22;--ninja-nya: #4169E1;--current-ninja-color: var(--ninja-lloyd);--bg-dark: #1a1a2e;--bg-medium: #16213e;--bg-light: #0f3460;--text-primary: #ffffff;--text-secondary: #b8b8b8;--accent-gold: #ffd700;--success: #4ade80;--error: #f87171;--font-main: "Nunito", "Segoe UI", system-ui, -apple-system, sans-serif;--font-display: "Fredoka", "Nunito", system-ui, sans-serif;--space-xs: .25rem;--space-sm: .5rem;--space-md: 1rem;--space-lg: 1.5rem;--space-xl: 2rem;--space-2xl: 3rem;--radius-sm: .5rem;--radius-md: 1rem;--radius-lg: 1.5rem;--radius-full: 9999px}*,*:before,*:after{box-sizing:border-box;margin:0;padding:0}html{font-size:16px;height:100%;overflow:hidden}body{font-family:var(--font-main);background:linear-gradient(135deg,var(--bg-dark) 0%,var(--bg-medium) 50%,var(--bg-light) 100%);color:var(--text-primary);min-height:100%;height:100%;line-height:1.5;overflow-y:auto;overflow-x:hidden;position:fixed;width:100%;-webkit-overflow-scrolling:touch}#app{min-height:100%;display:flex;flex-direction:column}.screen{flex:1;display:flex;flex-direction:column;align-items:center;padding:var(--space-lg);padding-bottom:env(safe-area-inset-bottom,var(--space-lg));max-width:800px;margin:0 auto;width:100%;overflow-y:auto}.hidden{display:none!important}.title{font-family:var(--font-display);font-size:clamp(2rem,8vw,3.5rem);text-align:center;background:linear-gradient(180deg,var(--accent-gold) 0%,#ff9500 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 4px 8px rgba(0,0,0,.3);margin-bottom:var(--space-sm);animation:titlePulse 2s ease-in-out infinite}@keyframes titlePulse{0%,to{transform:scale(1)}50%{transform:scale(1.02)}}.subtitle{font-size:1.25rem;color:var(--text-secondary);text-align:center;margin-bottom:var(--space-xl)}h2{font-size:1.25rem;color:var(--text-primary);margin-bottom:var(--space-md);text-align:center}.btn{font-family:var(--font-main);font-size:1.125rem;font-weight:600;padding:var(--space-md) var(--space-xl);border:none;border-radius:var(--radius-md);cursor:pointer;transition:all .2s ease;text-transform:uppercase;letter-spacing:.05em}.btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px #0000004d}.btn:active{transform:translateY(0)}.btn-start{background:linear-gradient(135deg,var(--current-ninja-color),#ff6b00);color:#fff;font-size:1.5rem;padding:var(--space-lg) var(--space-2xl);margin-top:var(--space-xl);animation:buttonGlow 2s ease-in-out infinite}@keyframes buttonGlow{0%,to{box-shadow:0 0 20px #ffd7004d}50%{box-shadow:0 0 40px #ffd70099}}.btn-submit{background:var(--current-ninja-color);color:#fff;min-width:120px}.btn-small{font-size:.875rem;padding:var(--space-sm) var(--space-md);background:#ffffff1a;color:var(--text-secondary)}.btn-small:hover{background:#fff3;color:var(--text-primary)}.btn-icon{font-size:1.5rem;padding:var(--space-sm);background:#ffffff1a;border-radius:var(--radius-full);width:48px;height:48px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.btn-icon:hover{background:#fff3;transform:scale(1.1)}.screen-header{width:100%;display:flex;justify-content:flex-end;margin-bottom:var(--space-md)}.ninja-selection{width:100%;margin-bottom:var(--space-xl)}.ninja-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:var(--space-md);max-width:600px;margin:0 auto}.ninja-card{background:#ffffff0d;border:3px solid transparent;border-radius:var(--radius-md);padding:var(--space-md);cursor:pointer;transition:all .3s ease;display:flex;flex-direction:column;align-items:center;gap:var(--space-xs)}.ninja-card:hover{background:#ffffff1a;transform:scale(1.05);border-color:var(--ninja-color)}.ninja-card.selected{background:#ffffff26;border-color:var(--ninja-color);box-shadow:0 0 20px var(--ninja-color)}.ninja-card-avatar{transition:transform .3s ease}.ninja-card:hover .ninja-card-avatar{transform:rotate(-5deg) scale(1.1)}.ninja-card-name{font-weight:700;font-size:1rem;color:var(--text-primary)}.ninja-card-element{font-size:.75rem;color:var(--text-secondary)}.difficulty-selection{width:100%;margin-bottom:var(--space-lg)}.difficulty-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:var(--space-md);max-width:900px;margin:0 auto}.difficulty-btn{background:#ffffff0d;border:3px solid rgba(255,255,255,.2);border-radius:var(--radius-md);padding:var(--space-md);cursor:pointer;transition:all .3s ease;display:flex;flex-direction:row;align-items:center;gap:var(--space-md);text-align:left}.difficulty-btn:hover{background:#ffffff1a;border-color:var(--ninja-color, var(--current-ninja-color));transform:scale(1.02)}.difficulty-btn.selected{background:linear-gradient(135deg,#ffffff26,#ffffff0d);border-color:var(--ninja-color, var(--current-ninja-color));box-shadow:0 0 20px #fff3,0 0 40px var(--ninja-color, var(--current-ninja-color))}.difficulty-ninja-avatar{flex-shrink:0;transition:transform .3s ease}.difficulty-btn:hover .difficulty-ninja-avatar{transform:rotate(-5deg) scale(1.1)}.difficulty-info{display:flex;flex-direction:column;gap:2px;flex:1}.difficulty-name{font-weight:700;font-size:1.1rem;color:var(--text-primary)}.difficulty-ninja-name{font-weight:600;font-size:.95rem;color:var(--ninja-color, var(--current-ninja-color))}.difficulty-desc{font-size:.8rem;color:var(--text-secondary)}.difficulty-ability{font-size:.75rem;color:var(--accent-gold);font-style:italic}.no-timer-badge{display:inline-block;background:linear-gradient(135deg,#4caf50,#2e7d32);color:#fff;font-size:.7rem;font-weight:700;padding:2px 8px;border-radius:var(--radius-sm);margin-top:4px}.difficulty-btn.selected .difficulty-desc{color:#fffc}.high-score-display{font-size:1.25rem;color:var(--accent-gold);display:flex;align-items:center;gap:var(--space-sm)}#high-score-value{font-weight:700;font-size:1.5rem}.game-header{width:100%;display:flex;justify-content:space-between;align-items:center;padding:var(--space-md);background:#0003;border-radius:var(--radius-md);margin-bottom:var(--space-lg)}.score-display,.enemies-display,.damage-display{font-size:1.25rem;display:flex;align-items:center;gap:var(--space-xs)}#current-score,#current-enemies,#current-damage{font-weight:700;color:var(--accent-gold);font-size:1.5rem}.enemies-display{background:linear-gradient(135deg,#80008033,#9400d31a);padding:4px 10px;border-radius:var(--radius-md);border:1px solid rgba(148,0,211,.3)}#current-enemies{color:orchid}.damage-display{background:linear-gradient(135deg,#f443,#ff64641a);padding:4px 10px;border-radius:var(--radius-md);border:1px solid rgba(255,68,68,.3)}#current-damage{color:#ff6b6b}.ninja-avatar{margin:var(--space-lg) 0;transition:transform .3s ease}.ninja-avatar.celebrate{animation:celebrate .5s ease}.ninja-avatar.shake{animation:shake .5s ease}@keyframes celebrate{0%,to{transform:scale(1) rotate(0)}25%{transform:scale(1.2) rotate(-10deg)}50%{transform:scale(1.2) rotate(10deg)}75%{transform:scale(1.1) rotate(-5deg)}}@keyframes shake{0%,to{transform:translate(0)}20%{transform:translate(-10px)}40%{transform:translate(10px)}60%{transform:translate(-10px)}80%{transform:translate(10px)}}.problem-container{background:#ffffff1a;border-radius:var(--radius-lg);padding:var(--space-xl);margin-bottom:var(--space-lg);min-width:280px}.problem-display{font-family:var(--font-display);font-size:clamp(2rem,10vw,4rem);font-weight:700;text-align:center;color:var(--text-primary);text-shadow:0 2px 4px rgba(0,0,0,.3)}.answer-display-container{display:flex;justify-content:center;margin-bottom:var(--space-md)}.answer-display{font-family:var(--font-display);font-size:2.5rem;min-width:120px;padding:var(--space-sm) var(--space-lg);text-align:center;border:3px solid var(--current-ninja-color);border-radius:var(--radius-md);background:#fffffff2;color:var(--bg-dark);box-shadow:0 4px 15px #0003}.answer-display.shake{animation:shake .5s ease;border-color:var(--error)}.keyboard-wrapper{display:flex;gap:var(--space-sm);justify-content:center;margin-bottom:var(--space-md);padding:0 var(--space-sm)}.numpad{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;flex-shrink:0}.numpad-btn{font-family:var(--font-display);font-size:1.5rem;font-weight:600;width:52px;height:48px;border:none;border-radius:var(--radius-sm);background:#ffffff26;color:var(--text-primary);cursor:pointer;transition:all .15s ease;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.numpad-btn:hover{background:#ffffff40}.numpad-btn:active{background:var(--current-ninja-color);transform:scale(.95)}.numpad-zero{grid-column:span 2;width:auto}.keyboard-actions{display:flex;flex-direction:column;gap:6px}.action-btn{font-size:1.75rem;width:64px;border:none;border-radius:var(--radius-sm);cursor:pointer;transition:all .15s ease;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;display:flex;align-items:center;justify-content:center}.action-backspace{height:48px;background:#ff64644d;color:var(--text-primary)}.action-backspace:hover{background:#ff646480}.action-backspace:active{background:var(--error);transform:scale(.95)}.action-attack{flex:1;min-height:150px;background:linear-gradient(135deg,var(--current-ninja-color),#ff6b00);color:#fff;font-size:2.5rem;box-shadow:0 4px 15px #0000004d}.action-attack:hover{transform:translateY(-2px);box-shadow:0 6px 20px #0006}.action-attack:active{transform:scale(.98);box-shadow:0 2px 10px #0000004d}#answer-input{position:absolute;opacity:0;pointer-events:none}.answer-container{display:none}.feedback{font-size:1.5rem;font-weight:700;min-height:2rem;text-align:center;transition:all .3s ease}.feedback.correct{color:var(--success);animation:popIn .3s ease}.feedback.incorrect{color:var(--error);animation:popIn .3s ease}@keyframes popIn{0%{transform:scale(0);opacity:0}50%{transform:scale(1.2)}to{transform:scale(1);opacity:1}}.ninja-message{font-size:1.125rem;font-style:italic;text-align:center;min-height:1.5rem;padding:var(--space-md);border-radius:var(--radius-md);max-width:400px;transition:all .3s ease}.ninja-message.encouragement{background:#4ade8033;color:var(--success)}.ninja-message.comfort{background:#f8717133;color:var(--error)}@media(max-width:600px){.screen{padding:var(--space-md);padding-bottom:calc(env(safe-area-inset-bottom,0px) + var(--space-md))}.difficulty-buttons{grid-template-columns:1fr}.difficulty-btn{padding:var(--space-sm)}.difficulty-ninja-avatar svg{width:50px;height:50px}.difficulty-name{font-size:1rem}.difficulty-ninja-name{font-size:.85rem}.difficulty-desc,.difficulty-ability{font-size:.7rem}.game-header{flex-wrap:wrap;gap:var(--space-sm);position:sticky;top:0;z-index:10;background:#1a1a2ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);margin:calc(-1 * var(--space-md));margin-bottom:var(--space-md);padding:var(--space-sm);border-radius:0 0 var(--radius-md) var(--radius-md)}.ninja-avatar{margin:var(--space-sm) 0}.ninja-avatar svg{width:80px;height:80px}.problem-container{padding:var(--space-sm);margin-bottom:var(--space-sm)}.problem-display{font-size:clamp(1.5rem,7vw,2.5rem)}.answer-display{font-size:2rem;padding:var(--space-xs) var(--space-md);min-width:100px}.feedback{font-size:1rem;min-height:1.5rem}.ninja-message{font-size:.875rem;padding:var(--space-xs);margin-bottom:var(--space-sm);min-height:1rem}}@media(max-height:500px)and (orientation:landscape){.ninja-avatar,.enemy-avatar{display:none}.screen{padding:var(--space-sm)}.problem-container{padding:var(--space-xs);margin-bottom:var(--space-xs)}.keyboard-wrapper{margin-bottom:var(--space-xs)}.numpad-btn{height:40px}.action-attack{min-height:100px}}@media(prefers-reduced-motion:reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}:focus-visible{outline:3px solid var(--accent-gold);outline-offset:2px}.battle-arena{display:flex;justify-content:space-between;align-items:center;width:100%;max-width:500px;padding:var(--space-md);background:linear-gradient(180deg,#0000004d,#0000001a);border-radius:var(--radius-lg);margin-bottom:var(--space-md);position:relative;overflow:hidden}.battle-arena:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at center,rgba(255,255,255,.05) 0%,transparent 70%);pointer-events:none}.fighter{display:flex;flex-direction:column;align-items:center;gap:var(--space-sm);z-index:1;position:relative}.fighter-player{animation:fighterIdle 2s ease-in-out infinite}.fighter-enemy{animation:fighterIdleEnemy 2s ease-in-out infinite .5s}.enemy-name-container{text-align:center;margin-bottom:4px}.enemy-name{font-family:var(--font-display);font-size:.8rem;font-weight:700;color:#fff;background:linear-gradient(135deg,#8b4513e6,#643214e6);padding:2px 10px;border-radius:12px;border:2px solid #daa520;text-shadow:0 1px 2px rgba(0,0,0,.8);box-shadow:0 2px 6px #0000004d;display:inline-block;transition:all .3s ease}.enemy-name.boss-name{background:linear-gradient(135deg,#b40000f2,#640000f2);border-color:#f44;animation:bossNamePulse 1.5s ease-in-out infinite}@keyframes bossNamePulse{0%,to{box-shadow:0 2px 6px #ff00004d}50%{box-shadow:0 2px 16px #f009}}@keyframes fighterIdle{0%,to{transform:translateY(0)}50%{transform:translateY(-5px)}}@keyframes fighterIdleEnemy{0%,to{transform:translateY(0)}50%{transform:translateY(-5px)}}.fighter-enemy .enemy-avatar{transform:scaleX(-1)}.fighter .ninja-avatar,.enemy-avatar{width:80px;height:80px;margin:0}.fighter .ninja-avatar svg,.enemy-avatar svg{width:80px;height:80px}.health-bar{width:100px;height:12px;background:#00000080;border-radius:var(--radius-full);overflow:hidden;border:2px solid rgba(255,255,255,.3);position:relative}.health-fill{height:100%;background:linear-gradient(90deg,#f44,#f66);border-radius:var(--radius-full);transition:width .5s ease-out;position:relative}.health-fill:after{content:"";position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.3) 0%,transparent 100%);border-radius:var(--radius-full) var(--radius-full) 0 0}.fighter-player .health-fill{background:linear-gradient(90deg,#22c55e,#4ade80)}.fighter-enemy .health-fill{background:linear-gradient(90deg,#ef4444,#f87171)}.battle-vs{font-family:var(--font-display);font-size:1.5rem;color:var(--accent-gold);text-shadow:0 0 20px rgba(255,215,0,.5);animation:vsPulse 1s ease-in-out infinite}@keyframes vsPulse{0%,to{transform:scale(1);opacity:.8}50%{transform:scale(1.1);opacity:1}}.battle-effect{position:absolute;inset:0;pointer-events:none;z-index:10}.battle-effect.player-attack:after{content:"üí•";position:absolute;font-size:3rem;right:15%;top:50%;transform:translateY(-50%);animation:attackHit .5s ease-out forwards}.battle-effect.enemy-attack:after{content:"üí¢";position:absolute;font-size:3rem;left:15%;top:50%;transform:translateY(-50%);animation:attackHit .5s ease-out forwards}@keyframes attackHit{0%{opacity:0;transform:translateY(-50%) scale(.5)}30%{opacity:1;transform:translateY(-50%) scale(1.5)}to{opacity:0;transform:translateY(-50%) scale(.5)}}.battle-effect.enemy-defeated:before{content:"‚≠ê";position:absolute;right:10%;top:30%;font-size:2rem;animation:starBurst 1s ease-out forwards}.battle-effect.enemy-defeated:after{content:"üèÜ";position:absolute;right:15%;top:40%;font-size:2.5rem;animation:starBurst 1s ease-out .2s forwards}@keyframes starBurst{0%{opacity:0;transform:scale(0) rotate(-180deg)}50%{opacity:1;transform:scale(1.3) rotate(0)}to{opacity:0;transform:scale(.5) translateY(-50px) rotate(180deg)}}.enemy-spawn{animation:enemySpawnIn .6s cubic-bezier(.34,1.56,.64,1) forwards}@keyframes enemySpawnIn{0%{opacity:0;transform:scale(0) rotate(-180deg);filter:brightness(2) blur(10px)}50%{opacity:.7;filter:brightness(1.5) blur(3px)}to{opacity:1;transform:scale(1) rotate(0);filter:brightness(1) blur(0)}}.enemy-avatar .boss-glow{animation:bossGlow 2s ease-in-out infinite}@keyframes bossGlow{0%,to{filter:drop-shadow(0 0 10px #ff0000) drop-shadow(0 0 20px #ff4400)}50%{filter:drop-shadow(0 0 20px #ff4400) drop-shadow(0 0 40px #ff0000)}}.damage-popup{position:absolute;font-family:var(--font-display);font-size:1.5rem;font-weight:700;color:#f44;text-shadow:0 2px 4px rgba(0,0,0,.5),0 0 10px rgba(255,0,0,.5);animation:damageFloat 1s ease-out forwards;z-index:20;pointer-events:none}.damage-popup.heal{color:#4ade80;text-shadow:0 2px 4px rgba(0,0,0,.5),0 0 10px rgba(0,255,0,.5)}@keyframes damageFloat{0%{opacity:1;transform:translateY(0) scale(.5)}20%{transform:translateY(-10px) scale(1.2)}to{opacity:0;transform:translateY(-50px) scale(.8)}}.idle-timer{width:100%;max-width:300px;height:8px;background:#0000004d;border-radius:var(--radius-full);overflow:hidden;margin:var(--space-sm) 0;border:1px solid rgba(255,255,255,.1)}.idle-timer-fill{height:100%;background:linear-gradient(90deg,#fbbf24,#f59e0b);border-radius:var(--radius-full);transition:width .1s linear;position:relative}.idle-timer-fill:after{content:"";position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.4) 0%,transparent 100%)}.idle-timer.warning .idle-timer-fill{background:linear-gradient(90deg,#ef4444,#f87171);animation:timerWarning .5s ease-in-out infinite}@keyframes timerWarning{0%,to{opacity:1}50%{opacity:.7}}#gameover-screen{justify-content:center;text-align:center}.gameover-content{display:flex;flex-direction:column;align-items:center;gap:var(--space-lg);padding:var(--space-xl);background:#00000080;border-radius:var(--radius-lg);border:2px solid rgba(255,100,100,.3);animation:gameOverAppear .5s ease-out}@keyframes gameOverAppear{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}.gameover-title{font-family:var(--font-display);font-size:clamp(2rem,8vw,3rem);color:#ef4444;text-shadow:0 0 30px rgba(239,68,68,.5);animation:gameOverPulse 2s ease-in-out infinite}@keyframes gameOverPulse{0%,to{text-shadow:0 0 20px rgba(239,68,68,.5)}50%{text-shadow:0 0 40px rgba(239,68,68,.8)}}.victory-title{font-family:var(--font-display);font-size:clamp(2rem,8vw,3.5rem);background:linear-gradient(180deg,gold,#ff9500,gold);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 0 30px rgba(255,215,0,.8);animation:victoryPulse 1.5s ease-in-out infinite}@keyframes victoryPulse{0%,to{transform:scale(1);filter:brightness(1)}50%{transform:scale(1.05);filter:brightness(1.2)}}.victory-message{text-align:center;margin-bottom:var(--space-lg)}.victory-hero{font-family:var(--font-display);font-size:clamp(1.5rem,5vw,2rem);color:var(--accent-gold);text-shadow:0 0 20px rgba(255,215,0,.6);margin-bottom:var(--space-sm);animation:heroGlow 2s ease-in-out infinite}@keyframes heroGlow{0%,to{text-shadow:0 0 20px rgba(255,215,0,.6)}50%{text-shadow:0 0 40px rgba(255,215,0,1),0 0 60px rgba(255,107,0,.8)}}.victory-stats{background:linear-gradient(135deg,#ffd7001a,#ff6b001a);border:2px solid var(--accent-gold);border-radius:var(--radius-lg);padding:var(--space-lg)}#victory-screen{background:radial-gradient(ellipse at center,rgba(255,215,0,.1) 0%,transparent 70%)}.gameover-stats{display:flex;flex-direction:column;gap:var(--space-sm);font-size:1.25rem}.gameover-stats span{display:flex;align-items:center;justify-content:center;gap:var(--space-sm)}.gameover-message{font-size:1.125rem;color:var(--text-secondary);max-width:300px}.gameover-buttons{display:flex;gap:var(--space-md);flex-wrap:wrap;justify-content:center}.btn-restart{background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff}.btn-menu{background:linear-gradient(135deg,var(--bg-light),var(--bg-medium));color:var(--text-primary);border:2px solid rgba(255,255,255,.2)}@media(max-width:480px){.battle-arena{padding:var(--space-sm);gap:var(--space-sm)}.fighter .ninja-avatar,.enemy-avatar{width:60px;height:60px}.fighter .ninja-avatar svg,.enemy-avatar svg{width:60px;height:60px}.health-bar{width:70px;height:10px}.battle-vs,.damage-popup{font-size:1.25rem}.gameover-content{padding:var(--space-md)}.gameover-buttons{flex-direction:column;width:100%}.gameover-buttons .btn{width:100%}}.screen-shake{animation:screenShake .5s cubic-bezier(.36,.07,.19,.97) both}@keyframes screenShake{0%,to{transform:translate(0)}10%{transform:translate(-10px) rotate(-1deg)}20%{transform:translate(10px) rotate(1deg)}30%{transform:translate(-10px) rotate(-1deg)}40%{transform:translate(10px) rotate(1deg)}50%{transform:translate(-5px) rotate(-.5deg)}60%{transform:translate(5px) rotate(.5deg)}70%{transform:translate(-2px)}80%{transform:translate(2px)}90%{transform:translate(-1px)}}.critical-hit{animation:criticalHit .3s ease-out}@keyframes criticalHit{0%{filter:brightness(1)}25%{filter:brightness(3) saturate(2)}50%{filter:brightness(.5) hue-rotate(180deg)}to{filter:brightness(1)}}.boss-entrance{animation:bossEntrance 1.5s cubic-bezier(.34,1.56,.64,1) forwards}@keyframes bossEntrance{0%{opacity:0;transform:scale(3) rotate(720deg);filter:blur(20px) brightness(3)}40%{opacity:.8;transform:scale(.8) rotate(0);filter:blur(5px) brightness(1.5)}60%{transform:scale(1.3) rotate(-10deg);filter:blur(0) brightness(1)}80%{transform:scale(.95) rotate(5deg)}to{opacity:1;transform:scale(1) rotate(0);filter:blur(0) brightness(1)}}.particle-container{position:absolute;top:50%;left:50%;pointer-events:none;z-index:100}.particle{position:absolute;width:8px;height:8px;border-radius:50%;animation:particleBurst 1s ease-out forwards}@keyframes particleBurst{0%{opacity:1;transform:translate(-50%,-50%) scale(1)}to{opacity:0;transform:translate(var(--tx),var(--ty)) scale(0)}}.lightning-effect{position:fixed;inset:0;pointer-events:none;z-index:1000;animation:lightningFlash .15s ease-out}@keyframes lightningFlash{0%{background:#ffffffe6}to{background:transparent}}.story-overlay{position:fixed;inset:0;background:#000000f2;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:2000;padding:var(--space-xl);animation:storyFadeIn .5s ease-out}@keyframes storyFadeIn{0%{opacity:0}to{opacity:1}}.story-overlay.fade-out{animation:storyFadeOut .5s ease-in forwards}@keyframes storyFadeOut{0%{opacity:1}to{opacity:0}}.story-text{font-family:var(--font-display);font-size:clamp(1.2rem,4vw,2rem);color:#fff;text-align:center;max-width:600px;line-height:1.8;animation:storyTextAppear 1s ease-out}@keyframes storyTextAppear{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.story-emoji{font-size:4rem;margin-bottom:var(--space-lg);animation:storyEmojiPulse 1s ease-in-out infinite}@keyframes storyEmojiPulse{0%,to{transform:scale(1)}50%{transform:scale(1.2)}}.story-skip{margin-top:var(--space-xl);font-size:.9rem;color:var(--text-secondary);animation:blink 1.5s ease-in-out infinite}@keyframes blink{0%,to{opacity:1}50%{opacity:.3}}.combo-display{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--font-display);font-size:5rem;font-weight:700;color:var(--accent-gold);text-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,107,0,.6);z-index:500;pointer-events:none;animation:comboAppear .8s cubic-bezier(.34,1.56,.64,1) forwards}@keyframes comboAppear{0%{opacity:0;transform:translate(-50%,-50%) scale(.3)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}to{opacity:0;transform:translate(-50%,-50%) scale(.8) translateY(-50px)}}.ultimate-attack{position:fixed;inset:0;pointer-events:none;z-index:1500;background:radial-gradient(circle at center,transparent 0%,transparent 30%,var(--current-ninja-color) 100%);animation:ultimateAttack .8s ease-out forwards}@keyframes ultimateAttack{0%{opacity:0;transform:scale(0)}30%{opacity:.8;transform:scale(1)}to{opacity:0;transform:scale(2)}}.power-up{animation:powerUpGlow .5s ease-out}@keyframes powerUpGlow{0%{filter:drop-shadow(0 0 5px var(--current-ninja-color))}50%{filter:drop-shadow(0 0 30px var(--current-ninja-color)) drop-shadow(0 0 60px var(--accent-gold))}to{filter:drop-shadow(0 0 5px var(--current-ninja-color))}}.enemy-death{animation:enemyDeath .6s ease-out forwards}@keyframes enemyDeath{0%{opacity:1;transform:scale(1);filter:brightness(1)}30%{transform:scale(1.3);filter:brightness(2) saturate(2)}60%{opacity:.5;transform:scale(.8);filter:brightness(3) hue-rotate(90deg)}to{opacity:0;transform:scale(0) rotate(180deg);filter:brightness(5) blur(10px)}}.level-up-effect{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--font-display);font-size:clamp(2rem,8vw,4rem);color:var(--accent-gold);text-shadow:0 0 20px rgba(255,215,0,1),0 0 40px rgba(255,107,0,.8);z-index:600;pointer-events:none;white-space:nowrap;animation:levelUp 1.5s cubic-bezier(.34,1.56,.64,1) forwards}@keyframes levelUp{0%{opacity:0;transform:translate(-50%,-50%) scale(0) rotate(-30deg)}30%{opacity:1;transform:translate(-50%,-50%) scale(1.3) rotate(10deg)}50%{transform:translate(-50%,-50%) scale(1) rotate(0)}70%{transform:translate(-50%,-50%) scale(1.1) rotate(-5deg)}to{opacity:0;transform:translate(-50%,-50%) scale(1.5) translateY(-100px)}}:root{--enemy-ambient-color: #4a0080}.floating-elements-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:-1;overflow:hidden}.floating-element{position:absolute;bottom:-50px;animation:floatUp linear infinite;filter:blur(1px);-webkit-user-select:none;user-select:none}@keyframes floatUp{0%{transform:translateY(0) rotate(0) scale(1);opacity:0}10%{opacity:var(--element-opacity, .3)}90%{opacity:var(--element-opacity, .3)}to{transform:translateY(-110vh) rotate(360deg) scale(.5);opacity:0}}.ambient-particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:-1;overflow:hidden}.ambient-particle{position:absolute;font-size:1rem;opacity:.2;animation:ambientFloat ease-in-out infinite;filter:blur(.5px);-webkit-user-select:none;user-select:none}@keyframes ambientFloat{0%,to{transform:translate(0) scale(1);opacity:.1}25%{transform:translate(20px,-30px) scale(1.2);opacity:.3}50%{transform:translate(-10px,-50px) scale(.8);opacity:.2}75%{transform:translate(-30px,-20px) scale(1.1);opacity:.25}}.vignette-overlay{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;transition:box-shadow 1.5s ease-in-out}.background-transition{animation:backgroundPulse 1s ease-out}@keyframes backgroundPulse{0%{filter:brightness(2) saturate(1.5)}50%{filter:brightness(1.5) saturate(1.3)}to{filter:brightness(1) saturate(1)}}.enemy-skeleton-bg:before{content:"";position:fixed;inset:0;background:radial-gradient(ellipse at center,transparent 0%,rgba(74,0,128,.1) 100%);pointer-events:none;z-index:-1}.boss-bg-flash{animation:bossBgFlash .5s ease-out}@keyframes bossBgFlash{0%{filter:brightness(3) contrast(1.2)}to{filter:brightness(1) contrast(1)}}.haptic-pulse{animation:hapticPulse .1s ease-out}@keyframes hapticPulse{0%{transform:scale(1)}50%{transform:scale(.98)}to{transform:scale(1)}}.elemental-effect{position:fixed;pointer-events:none;z-index:1000}.elemental-particle{position:absolute;font-size:1.5rem;animation:elementalBurst 1s ease-out forwards;filter:drop-shadow(0 0 10px var(--color, #fff))}@keyframes elementalBurst{0%{opacity:1;transform:translate(-50%,-50%) scale(.5) rotate(0)}to{opacity:0;transform:translate(calc(-50% + cos(calc(var(--i) * 30deg))*100px),calc(-50% + sin(calc(var(--i) * 30deg))*100px)) scale(1.5) rotate(360deg)}}.elemental-particle:nth-child(1){--tx: 100px;--ty: 0}.elemental-particle:nth-child(2){--tx: 87px;--ty: 50px}.elemental-particle:nth-child(3){--tx: 50px;--ty: 87px}.elemental-particle:nth-child(4){--tx: 0;--ty: 100px}.elemental-particle:nth-child(5){--tx: -50px;--ty: 87px}.elemental-particle:nth-child(6){--tx: -87px;--ty: 50px}.elemental-particle:nth-child(7){--tx: -100px;--ty: 0}.elemental-particle:nth-child(8){--tx: -87px;--ty: -50px}.elemental-particle:nth-child(9){--tx: -50px;--ty: -87px}.elemental-particle:nth-child(10){--tx: 0;--ty: -100px}.elemental-particle:nth-child(11){--tx: 50px;--ty: -87px}.elemental-particle:nth-child(12){--tx: 87px;--ty: -50px}.elemental-particle{animation:elementalBurstFallback 1s ease-out forwards}@keyframes elementalBurstFallback{0%{opacity:1;transform:translate(-50%,-50%) scale(.5)}to{opacity:0;transform:translate(calc(-50% + var(--tx, 0px)),calc(-50% + var(--ty, 0px))) scale(1.2)}}.elemental-effect.kai .elemental-particle{color:#f40;text-shadow:0 0 20px #ff6600,0 0 40px #ff4400}.elemental-effect.zane .elemental-particle{color:#87ceeb;text-shadow:0 0 20px #00ffff,0 0 40px #87ceeb}.elemental-effect.jay .elemental-particle{color:#ff0;text-shadow:0 0 20px #0088ff,0 0 40px #ffff00}.elemental-effect.cole .elemental-particle{color:#8b4513;text-shadow:0 0 20px #5a3510,0 0 40px #8b4513}.elemental-effect.nya .elemental-particle{color:#4169e1;text-shadow:0 0 20px #1e90ff,0 0 40px #4169e1}.elemental-effect.lloyd .elemental-particle{color:#228b22;text-shadow:0 0 20px #ffd700,0 0 40px #228b22}.health-fill{transition:width .3s ease-out,background .3s ease}.health-fill.animating{animation:healthPulse .3s ease-out}@keyframes healthPulse{0%{filter:brightness(2)}50%{filter:brightness(1.5)}to{filter:brightness(1)}}.health-fill.critical{animation:criticalPulse .5s ease-in-out infinite!important}@keyframes criticalPulse{0%,to{box-shadow:inset 0 0 10px #ff000080;filter:brightness(1)}50%{box-shadow:inset 0 0 20px #f00c;filter:brightness(1.3)}}.health-fill.low-health{background:linear-gradient(90deg,#ef4444,#dc2626)!important;animation:lowHealthWarning 1s ease-in-out infinite}@keyframes lowHealthWarning{0%,to{opacity:1;box-shadow:0 0 5px #ff000080}50%{opacity:.7;box-shadow:0 0 15px #f00c}}.health-bar-container.damage-shake{animation:healthBarShake .3s ease-out}@keyframes healthBarShake{0%,to{transform:translate(0)}25%{transform:translate(-3px)}75%{transform:translate(3px)}}.health-fill.health-high{background:linear-gradient(90deg,#22c55e,#4ade80)!important}.health-fill.health-medium{background:linear-gradient(90deg,#eab308,#facc15)!important}.health-fill.health-low{background:linear-gradient(90deg,#f97316,#fb923c)!important}.health-fill.health-critical{background:linear-gradient(90deg,#ef4444,#dc2626)!important}.health-text.changed{animation:healthTextPulse .3s ease-out}@keyframes healthTextPulse{0%{transform:scale(1)}50%{transform:scale(1.2);color:#fff}to{transform:scale(1)}}.problem-display{transition:transform .3s ease,opacity .3s ease}.problem-exit{animation:problemExit .15s ease-in forwards}@keyframes problemExit{0%{opacity:1;transform:scale(1) translateY(0)}to{opacity:0;transform:scale(.8) translateY(-20px)}}.problem-enter{animation:problemEnter .3s cubic-bezier(.34,1.56,.64,1) forwards}@keyframes problemEnter{0%{opacity:0;transform:scale(1.2) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}.combo-display{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--font-display);display:flex;flex-direction:column;align-items:center;z-index:500;pointer-events:none;animation:comboAppear 1s cubic-bezier(.34,1.56,.64,1) forwards}.combo-number{font-size:calc(4rem * var(--combo-scale, 1));font-weight:700;color:var(--accent-gold);text-shadow:0 0 var(--combo-glow, 20px) rgba(255,215,0,.8),0 0 calc(var(--combo-glow, 20px) * 2) rgba(255,107,0,.6);line-height:1}.combo-label{font-size:calc(1.5rem * var(--combo-scale, 1));color:#fff;text-shadow:0 2px 10px rgba(0,0,0,.5);letter-spacing:.1em}.combo-display.super .combo-number{color:#ff6b00;text-shadow:0 0 30px rgba(255,107,0,.9),0 0 60px rgba(255,68,0,.7)}.combo-display.super .combo-label{color:#ff6b00}.combo-display.epic .combo-number{color:#f0f;text-shadow:0 0 40px rgba(255,0,255,.9),0 0 80px rgba(200,0,255,.7);animation:epicPulse .3s ease-in-out infinite}.combo-display.epic .combo-label{color:#f0f;text-shadow:0 0 20px rgba(255,0,255,.8)}@keyframes epicPulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.combo-display.legendary .combo-number{background:linear-gradient(45deg,gold,#ff6b00,red,#f0f,#0ff,gold);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:legendaryRainbow 1s ease infinite,legendaryPulse .2s ease-in-out infinite;filter:drop-shadow(0 0 30px #ffd700) drop-shadow(0 0 60px #ff6b00)}.combo-display.legendary .combo-label{background:linear-gradient(45deg,gold,#ff6b00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:2rem}@keyframes legendaryRainbow{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@keyframes legendaryPulse{0%,to{transform:scale(1) rotate(-2deg)}50%{transform:scale(1.1) rotate(2deg)}}.combo-border-pulse:after{content:"";position:fixed;inset:0;pointer-events:none;z-index:400;border:8px solid transparent;animation:borderPulse 1s ease-out forwards}@keyframes borderPulse{0%{border-color:#f0fc;box-shadow:inset 0 0 50px #ff00ff80}to{border-color:transparent;box-shadow:inset 0 0 0 transparent}}.numpad-btn{position:relative;overflow:hidden;transition:all .15s ease}.numpad-btn.numpad-pressed{animation:numpadPress .15s ease-out;background:var(--current-ninja-color)!important;box-shadow:0 0 20px var(--current-ninja-color)}@keyframes numpadPress{0%{transform:scale(1)}50%{transform:scale(.9)}to{transform:scale(1)}}.numpad-btn:after{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background:#fff6;border-radius:50%;transform:translate(-50%,-50%);opacity:0}.numpad-btn.numpad-pressed:after{animation:numpadRipple .4s ease-out}@keyframes numpadRipple{0%{width:0;height:0;opacity:.5}to{width:150%;height:150%;opacity:0}}.numpad-btn:hover{box-shadow:0 0 15px #ffffff4d}.numpad-btn:active{background:var(--current-ninja-color)!important;transform:scale(.95);box-shadow:0 0 25px var(--current-ninja-color)}.action-attack{position:relative;overflow:hidden}.action-attack:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,transparent 30%,rgba(255,255,255,.2) 50%,transparent 70%);transform:translate(-100%);animation:attackReady 2s ease-in-out infinite}.action-attack:active:before{animation:none;transform:translate(100%);transition:transform .3s}@keyframes attackReady{0%{transform:translate(-100%)}to{transform:translate(100%)}}.action-backspace{position:relative;overflow:hidden}.action-backspace:active{background:var(--error)!important;transform:scale(.95)}
